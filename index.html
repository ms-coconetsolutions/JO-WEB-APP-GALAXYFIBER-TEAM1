<!DOCTYPE html>
<html>
<head>
  <link rel="icon" type="image/png" href="https://i.ibb.co/ZqC6Lpf/Galaxy-Fiber-Logo-350x100pixels.png">
  <title>FIELD ENGINEER JO WEBAPP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #f4f4f4; font-family: sans-serif; }
    
    /* Login Helper Styling */
    #auth-fallback {
      display: none; /* Hidden by default */
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
      padding: 20px;
    }
    .login-button {
      background-color: #4285F4;
      color: white;
      padding: 15px 25px;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
      margin-top: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    iframe {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    /* ------------------------------------- */
/* 0. CORE COLOR & FONT VARIABLES - REFINED FOR EXPENSIVE LOOK */
/* ------------------------------------- */
:root {
    /* --- CORE PALETTE: Deep & Rich Tones --- */
    --color-primary: #1e3a8a;       /* Deep Indigo/Sapphire Blue (Tech/Brand) */
    --color-secondary: #f4821e;     /* Vibrant Orange (Main Accent/Button Color) */
    
    /* --- NEW: High-End Backgrounds --- */
    --color-background: #f4f6f9;    /* Light Slate/Very Light Gray (Main Background) */
    --color-background-dark: #1f2937; /* Dark Mode/High Contrast Section Background */
    
    /* --- DERIVED/SUPPORT COLORS --- */
    --primary-accent: var(--color-primary); 
    --primary-hover: #1c2e6b;               /* Darker Primary for hover */
    
    --action-color: var(--color-secondary);
    --action-hover: #d16e1a;                /* Darker Secondary for hover */
    
    --card-bg: #ffffff;
    --text-dark: #111827;                   /* Near-Black (Deeper) for main text */
    --text-muted: #6b7280;                  /* Medium Gray for secondary text/labels */
    --border-color: #e5e7eb;                /* Lighter, softer border */
    --light-gray: #f9fafb;                  /* Off-white for light accents/containers */
    --medium-gray: #4b5563;                 /* Standard Gray */
    --border-gray: #d1d5db;
    --clear-red: #dc2626;                   /* Deep Red */
    --clear-red-hover: #b91c1c;             /* Darker Deep Red */
    
    /* --- SHADOWS --- */
    --shadow-subtle: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.03); /* Lighter card shadow */
    --shadow-medium: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05); /* Main container shadow */

    /* --- LAYOUT VARIABLES (UNCHANGED) --- */
    --sidebar-width: 320px; 
    --standard-padding: 22px; 
    --mobile-touch-height: 90px;
}


/* ------------------------------------- */
/* 1. GLOBAL & BODY STYLES - Enhanced Typography */
/* ------------------------------------- */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

body {
    /* Use a slightly bolder weight for overall "heft" */
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--color-background); 
    color: var(--text-dark);
    min-height: 100vh;
    transition: margin-left 0.3s ease, background-color 0.3s; /* Transition for smoothness */
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    font-size: 20px; 
}

h1, h2 {
    color: var(--text-dark);
    font-weight: 700; /* Bolder headings */
}

.app-page {
    display: none;
}

.app-page.active {
    display: block;
}

/* Save Status - Subtle Shadow */
#saveStatus {
    font-size: 24px; 
    margin-top: -18px;
    margin-bottom: 30px; 
    font-weight: 700; /* Bolder */
    color: var(--primary-accent);
    text-align: center;
    /* Subtle text shadow for pop */
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}

.message-box {
    margin-top: 25px; 
    padding: 20px; 
    border-radius: 8px;
    font-size: 24px; 
    font-weight: 600;
    text-align: center;
    /* Added subtle shadow to the message box */
    box-shadow: var(--shadow-subtle);
}

/* ------------------------------------- */
/* 2. LAYOUT: CONTAINER, HEADER & SEARCH - High-End Card Look */
/* ------------------------------------- */

/* Desktop Container (Main Content Wrapper) */
.container {
    max-width: 1300px; /* Slightly wider */
    margin: 60px auto; /* More margin top/bottom for breathing room */
    padding: 50px; /* More internal padding */
    background: var(--card-bg);
    border-radius: 20px; /* Softer rounded corners */
    /* Use the medium shadow variable */
    box-shadow: var(--shadow-medium); 
    border: 1px solid var(--border-color);
}

.logo-container {
    text-align: center;
    margin-bottom: 60px; /* More spacing */
}

.logo-container img {
    /* --- LOGO SIZE INCREASED --- */
    max-width: 900px; 
    height: auto;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15); /* Elevated shadow */
}

/* Search Group */
.search-container {
    text-align: center;
    margin-bottom: 50px; 
    gap: 25px; /* More space between input and button */
    justify-content: center;
    align-items: center;
}

.search-input {
    width: calc(100% - 180px); 
    max-width: 800px; /* Wider input */
    padding: 22px; 
    font-size: 28px; /* Slightly larger text */
    border: 1px solid var(--border-gray); /* Thinner initial border */
    border-radius: 12px; /* Softer radius */
    box-sizing: border-box;
    transition: border-color 0.3s, box-shadow 0.3s;
}
.search-input:focus {
    border-color: var(--primary-accent);
    /* Refined focus ring */
    box-shadow: 0 0 0 4px rgba(30, 58, 138, 0.2); 
    outline: none;
}

.search-button {
    padding: 22px 40px; 
    font-size: 28px; 
    background-color: var(--primary-accent);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s; 
    font-weight: 600; /* Bolder button text */
    box-shadow: 0 4px 10px rgba(30, 58, 138, 0.3); /* Accent shadow */
}

.search-button:hover {
    background-color: var(--primary-hover);
    transform: translateY(-2px); /* Higher lift on hover */
    box-shadow: 0 6px 15px rgba(30, 58, 138, 0.4);
}

/* ------------------------------------- */
/* 3. SIDEBAR AND NAVIGATION STYLES - Dark, High-Contrast Sidebar */
/* ------------------------------------- */

.menu-toggle {
    top: 30px; 
    left: 30px; 
    z-index: 1001;
    background-color: var(--primary-accent);
    color: white;
    border: none;
    padding: 20px 28px; 
    border-radius: 12px;
    cursor: pointer;
    font-size: 30px; 
    /* Deeper shadow */
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3); 
    transition: left 0.3s ease, background-color 0.2s, transform 0.1s;
}
.menu-toggle:hover {
    background-color: var(--primary-hover);
    transform: translateY(-1px);
}

.sidebar {
    height: 100%;
    width: 0;
    position: fixed;
    z-index: 1000;
    top: 0;
    left: 0;
    /* Use the dark background variable for luxury contrast */
    background-color: var(--color-background-dark); 
    overflow-x: hidden;
    transition: 0.3s;
    padding-top: 100px; /* More padding top */
    /* Deeper shadow */
    box-shadow: 8px 0 25px rgba(0, 0, 0, 0.5); 
}

.sidebar.open {
    width: var(--sidebar-width);
}

.sidebar-header {
    padding: 30px; 
    color: #ffffff; /* Pure white text for max contrast */
    text-align: center;
    /* Elegant line separator */
    border-bottom: 2px solid rgba(255, 255, 255, 0.1); 
    margin-bottom: 25px; 
    font-size: 30px; 
    font-weight: 700;
}

.menu-items {
    list-style: none;
    padding: 0;
    margin: 0;
}

.menu-item a {
    padding: 22px 35px; /* More padding */
    font-size: 26px; 
    color: #e5e7eb; /* Soft white text */
    display: block;
    transition: background-color 0.2s, transform 0.1s, color 0.2s;
    /* Sharper/modern radius */
    border-radius: 0 8px 8px 0;
    margin-right: 20px;
}

.menu-item a:hover {
    background-color: var(--primary-hover);
    transform: translateX(8px); /* More pronounced slide effect */
    color: #ffffff; /* White text on hover */
}

.menu-item a.active-page {
    background-color: var(--primary-accent);
    font-weight: 700;
    /* Stronger, more focused shadow */
    box-shadow: 0 2px 10px rgba(30, 58, 138, 0.6);
    color: #ffffff;
}

.main-content {
    margin-left: 0;
    padding: 40px; /* More padding */
    transition: margin-left 0.3s ease;
    min-height: 100vh;
}

.main-content.shifted {
    margin-left: var(--sidebar-width);
}


/* ------------------------------------- */
/* 4. TICKET CARD STYLES - Accordion-style depth */
/* ------------------------------------- */

.page {
    background-color: var(--card-bg);
    border-radius: 18px; /* Slightly more curved */
    /* Use subtle shadow */
    box-shadow: var(--shadow-subtle); 
    margin-bottom: 40px; 
    overflow: hidden;
    border: 1px solid var(--border-color);
}

.page-header {
    background-color: var(--primary-accent);
    color: #fff;
    padding: 30px 40px; /* More horizontal padding */
    border-radius: 18px 18px 0 0;
    font-size: 40px; 
    font-weight: 700;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    /* Subtle gradient for depth */
    background-image: linear-gradient(to right, var(--primary-accent), #264a9c); 
    box-shadow: inset 0 -4px 6px rgba(0, 0, 0, 0.2); 
    transition: opacity 0.2s;
}

.page-header:hover {
    opacity: 0.95; /* Dim slightly on hover */
    background-color: var(--primary-hover);
}

.page-subheader {
    background-color: var(--color-secondary);
    color: var(--text-dark);
    padding: 25px 40px; 
    border-radius: 0 0 18px 18px;
    font-size: 30px; 
    font-weight: 600;
    border-top: 1px solid var(--border-color);
}

.page-content {
    padding: 20px; /* More internal padding */
    display: none;
    background-color: var(--color-background);
    border-top: 1px solid var(--border-color);
}

.page-content label {
    font-size: 28px;
    font-weight: 700;
    color: var(--medium-gray); 
    display: block;
    margin-bottom: 10px;
    margin-top: 25px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    /* *** ADDED IMPROVEMENT *** */
    border-left: 5px solid var(--color-primary); /* Bold primary color accent line */
    padding-left: 15px; /* Padding to separate text from the line */
}

.page-content span {
    font-size: 30px; 
    font-weight: 500;
    color: var(--text-dark);
    display: block;
    margin-bottom: 20px; 
}
.page-content .ticket-details {
    margin-bottom: 40px; 
    padding: 25px; 
    background-color: var(--light-gray);
    border-radius: 10px;
    font-size: 30px; 
    /* Inner shadow for detail box */
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.08);
}

.page-content .select-container {
    margin-bottom: 25px; 
}


/* ------------------------------------- */
/* 5. INPUT & DROPDOWN STYLES - Polished and Elevated */
/* ------------------------------------- */

/* Dropdown/Input Styles - BASE TOUCH TARGET SIZE (70px height) */
select, .materials-input {
    /* Enhanced Core Styling */
    padding: 20px 25px; 
    font-size: 28px; 
    height: 70px;
    width: 100%;
    margin-top: 0;
    
    /* Visual Refinements */
    border: 1px solid var(--border-gray);
    border-radius: 12px; /* Increased radius for softness */
    background-color: var(--card-bg);
    box-sizing: border-box;
    
    /* UX & Consistency */
    cursor: pointer; /* Clear indication of interactivity */
    appearance: none; /* Removed default browser styling for select */
    -webkit-appearance: none;
    
    /* Deeper Inner Shadow for Recessed Look */
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1); 
    transition: border-color 0.2s, box-shadow 0.2s, background-color 0.2s;
}

/* Hover State */
select:hover, .materials-input:hover {
    background-color: var(--light-gray); /* Subtle background lift */
    border-color: var(--medium-gray); /* Border slightly darkens */
}

select:focus, .materials-input:focus {
    /* Sharper Focus Ring */
    border-color: var(--primary-accent);
    box-shadow: 0 0 0 4px rgba(30, 58, 138, 0.25), inset 0 2px 4px rgba(0, 0, 0, 0.1); /* Brighter focus glow */
    outline: none;
    cursor: text; /* Show text cursor when active for better UX */
}

/* Materials Input Styles - Refined for professional forms */
.materials-input {
    margin-top: 20px; 
    cursor: text; /* Correct default cursor for typing */
    
    /* Ensure no visual properties are accidentally overridden by general input rules */
    box-sizing: border-box; 
    /* NEW: Subtle transition to ensure smooth entry into focused state */
    transition: box-shadow 0.2s, border-color 0.2s; 
    
    /* Ensure text placeholder is readable (based on existing variables) */
    color: var(--text-dark); 
}

/* Optional: Add specific error styling for high-end feedback */
.materials-input.error {
    border-color: var(--clear-red);
    box-shadow: 0 0 0 1px var(--clear-red);
}

/* Horizontal Input Container (For FROM/TO fields) */
.from-to-container {
    display: flex;
    gap: 25px; 
    margin-top: 20px; 
}

/* Dynamic Material Row Layout */
.dynamic-material-row {
    display: flex; /* Ensure these are flexed for proper button alignment */
    align-items: center;
    gap: 20px; 
    margin-bottom: 20px; 
}

/* Base style for material input in dynamic row */
.dynamic-material-row .materials-input {
    flex-grow: 1; /* Allows the material name to take up remaining space */
    font-size: 28px; 
    padding: 20px 25px; 
    height: 70px; 
}

/* Number Input Style - Sharper and narrower */
.dynamic-material-row input[type="number"] {
    width: 120px; /* Slightly narrower to emphasize quantity */
    max-width: 120px;
    font-size: 28px; 
    padding: 20px 15px; /* Reduced right padding */
    height: 70px; 
    text-align: right; /* Right align number for professional look */
    /* Inherit base input styling */
    border: 1px solid var(--border-gray);
    border-radius: 12px;
    box-sizing: border-box;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: border-color 0.2s, box-shadow 0.2s;
}
.dynamic-material-row input[type="number"]:focus {
    border-color: var(--primary-accent);
    box-shadow: 0 0 0 4px rgba(30, 58, 138, 0.25), inset 0 2px 4px rgba(0, 0, 0, 0.1);
    outline: none;
}


/* Delete Button Specific Style - Elevated, destructive look */
.delete-material-button {
    background-color: var(--clear-red);
    color: white;
    padding: 20px 25px; 
    border: none;
    border-radius: 12px;
    font-size: 30px; 
    cursor: pointer;
    font-weight: 700; /* Bolder for impact */
    transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s; 
    height: 70px; 
    line-height: 0; 
    flex-shrink: 0;
    margin-top: 0 !important;
    /* Deeper, more noticeable shadow for lift */
    box-shadow: 0 4px 8px rgba(220, 38, 38, 0.5); 
}

.delete-material-button:hover {
    background-color: var(--clear-red-hover);
    transform: translateY(-3px); /* Increased lift on hover */
    box-shadow: 0 6px 12px rgba(220, 38, 38, 0.7); /* Stronger shadow on hover */
}

/* Dynamic Materials Container - Elegant wrapper */
.dynamic-materials-container {
    margin-top: 30px; 
    padding: 10px; /* Slightly more padding for air */
    border: 1px solid var(--border-gray);
    border-radius: 15px; /* Softer radius */
    background-color: var(--light-gray);
    /* Subtle inner glow for a "recessed panel" look */
    box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.05); 
}

.dynamic-materials-container p {
    font-size: 20px; 
    color: var(--medium-gray);
    margin: 0 0 20px 0; /* Increased margin below */
    font-weight: 600;
}

/* ------------------------------------- */
/* 6. BUTTON STYLES - Deep Shadow and Lift */
/* ------------------------------------- */

/* Button Group Styles */
.button-container {
    gap: 25px; 
    margin: 0px 0; 
}

/* Status Button (Primary Action) */
.status-button {
    padding: 25px 30px; 
    font-size: 30px;
    background-color: var(--action-color);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.1s, box-shadow 0.3s;
    flex-grow: 1;
    font-weight: 700;
    text-transform: uppercase;
    min-height: 75px; 
    /* Action button shadow */
    box-shadow: 0 4px 10px rgba(244, 130, 30, 0.4);
}

.status-button:hover:not(:disabled) {
    background-color: var(--action-hover);
    transform: translateY(-3px); /* Higher lift */
    box-shadow: 0 6px 15px rgba(244, 130, 30, 0.6);
}

.status-button:disabled {
    background-color: #c6c6c6;
    box-shadow: none; /* No shadow when disabled */
    cursor: not-allowed;
    transform: none;
}

/* Add Material Button */
.add-material-button {
    margin-top: 25px; 
    padding: 22px; 
    background-color: var(--primary-accent);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 30px; 
    cursor: pointer;
    font-weight: 700;
    transition: background-color 0.2s ease, transform 0.1s, box-shadow 0.2s;
    box-shadow: 0 4px 8px rgba(30, 58, 138, 0.3);
}

.add-material-button:hover {
    background-color: var(--primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(30, 58, 138, 0.4);
}

/* Save Button (Main Form Submit) */
.save-button {
    background-color: var(--action-color);
    color: #fff;
    border: none;
    padding: 28px 45px; 
    border-radius: 12px;
    cursor: pointer;
    font-size: 32px; 
    font-weight: 800; /* Extra bold */
    margin-top: 50px; 
    transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.3s;
    text-transform: uppercase;
    width: 100%;
    min-height: 80px; 
    /* Prominent shadow */
    box-shadow: 0 6px 15px rgba(244, 130, 30, 0.4);
}

.save-button:hover:not(:disabled) {
    background-color: var(--action-hover);
    transform: translateY(-4px); /* Max lift */
    box-shadow: 0 8px 20px rgba(244, 130, 30, 0.7);
}


/* ------------------------------------- */
/* 7. SIGNATURE & UPLOAD STYLES - Clean & Structured */
/* ------------------------------------- */

.signature-group {
    margin-top: 30px; 
    padding: 20px; 
    border: 2px solid var(--border-gray); /* Softer border */
    border-radius: 18px; 
    background-color: var(--light-gray);
    box-shadow: var(--shadow-subtle);
}

.signature-group h2 {
    font-size: 34px; 
    margin-bottom: 25px; 
    text-align: center;
    color: var(--text-dark);
}

.signature-group canvas {
    border: 1px solid var(--border-gray);
    background-color: var(--card-bg);
    width: 100%;
    height: 400px; /* Taller */
    touch-action: none;
    border-radius: 10px;
    display: block;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Clear Signature Button */
.signature-group .status-button {
    background-color: var(--clear-red);
    margin-top: 20px; 
    width: 100%;
    padding: 22px; 
    font-size: 30px; 
    box-shadow: 0 4px 10px rgba(220, 38, 38, 0.4);
}

/* Upload Form Styles */
.upload-form {
    margin-top: 50px; 
    padding-top: 40px; 
    border-top: 2px solid var(--border-color); /* Solid separator */
}

.upload-form h1 {
    font-size: 40px; 
    text-align: center;
    margin-bottom: 40px; 
}

.upload-form h2 {
    font-size: 30px; 
    margin-top: 30px; 
    color: var(--primary-accent);
    border-bottom: 2px solid var(--border-color);
    padding-bottom: 12px; 
}

.file-group {
    margin-bottom: 25px; 
    padding: 30px; 
    border: 1px solid var(--border-gray);
    border-radius: 12px;
    background-color: var(--card-bg);
    box-shadow: var(--shadow-subtle);
}

.file-group label {
    font-size: 26px; 
    font-weight: 700;
    margin-bottom: 15px; 
    color: var(--text-dark);
}

.file-group input[type="file"] {
    display: block;
    width: 100%;
    padding: 20px 0; 
    font-size: 26px; 
}

.file-group-nested {
    margin-top: 20px; 
    padding: 25px; 
    /* Thicker, more pronounced accent border */
    border-left: 4px solid var(--primary-accent);
    background-color: var(--light-gray);
    border-radius: 6px;
}


/* ------------------------------------- */
/* 8. TABLE STYLES (for Stocks/Consumption) - Elevated Data Presentation */
/* ------------------------------------- */

.data-table-container {
    margin: 50px auto; 
    overflow-x: auto; 
    border-radius: 18px;
    box-shadow: var(--shadow-medium); 
    border: 1px solid var(--border-color);
}

.data-table {
    width: 100%;
    border-collapse: separate; /* Use separate for rounded corners on the table header */
    border-spacing: 0;
    background-color: var(--card-bg);
    min-width: 900px; 
    table-layout: fixed; 
}

.data-table th, .data-table td {
    padding: 25px; /* More padding */
    border-bottom: 1px solid var(--border-color); 
    font-size: 26px; /* Larger font */
}

.data-table th { 
    background-color: var(--primary-accent); 
    color: white; 
    font-weight: 700; 
    text-transform: uppercase; 
    position: sticky; 
    top: 0; 
    text-align: left; 
    /* Added subtle gradient for depth */
    background-image: linear-gradient(to right, var(--primary-accent), #264a9c); 
}

/* Rounded corners for the header */
.data-table th:first-child { border-top-left-radius: 18px; }
.data-table th:last-child { border-top-right-radius: 18px; }


.data-table tr:nth-child(even) {
    background-color: var(--light-gray);
}

.data-table tr:hover {
    background-color: #e5e7eb; /* Better hover color */
    transition: background-color 0.2s;
}

/* Action Buttons within tables */
.stock-action-button {
    padding: 18px 25px; 
    font-size: 24px; 
    border-radius: 10px;
    margin-right: 10px;
    font-weight: 600;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* --- Status Indicators --- */
.status-badge {
    padding: 12px 18px; 
    border-radius: 30px; /* More rounded */
    font-weight: 700;
    font-size: 24px; 
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15); /* Subtle lift */
}

.status-badge.Complete {
    /* Use primary accent for a professional "done" color */
    background-color: var(--primary-accent); 
    color: white;
}


/* ------------------------------------- */
/* 9. MULTISELECT STYLES - Clean Pop-up */
/* ------------------------------------- */

.multiselect-display {
    padding: 22px 30px; 
    border: 1px solid var(--border-gray);
    border-radius: 10px;
    font-size: 30px; 
    box-shadow: var(--shadow-subtle);
}

.multiselect-options {
    z-index: 100;
    max-height: 450px;
    /* --- FIX 1: ADD SCROLL TO CONTAINER --- */
    /* This ensures the entire popup adheres to the max-height and scrolls */
    overflow-y: auto; 
    /* This makes the search bar stack above the columns wrapper */
    display: flex; 
    flex-direction: column;

    border: 1px solid var(--border-gray);
    background: #ffffff;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
    gap: 30px; 
    min-width: 600px;
}

/* --- NEW WRAPPER STYLES FOR SCROLL AND LAYOUT --- */
.multiselect-columns-wrapper {
    display: flex;
    flex-wrap: nowrap;
    gap: 30px;
    padding: 0 15px 15px 15px; /* Adjust padding to sit nicely inside the main div */
    width: 100%;
    /* Note: We removed overflow-y from here and moved it to multiselect-options */
}

.multiselect-column {
    /* FIX 2: Ensure columns can grow but stop at 50% */
    flex: 1 1 50%;
    min-width: 0; 
}

.category-title {
    font-weight: 800; 
    color: var(--primary-accent);
    font-size: 34px; 
    border-bottom: 3px solid var(--border-gray); 
    margin-bottom: 20px; 
    padding-top: 8px;
}

/* Ensure checkbox and text align nicely */
.multiselect-options label {
    display: flex; /* Use flex on the label itself */
    align-items: center;
    gap: 15px; /* Space between checkbox and text */
    padding: 12px 10px; 
    font-size: 30px; 
    cursor: pointer;
    transition: background-color 0.15s;
}

.multiselect-options label:hover {
    background-color: var(--light-gray); 
    border-radius: 5px; 
}

.multiselect-options input[type="checkbox"] {
    width: 30px; 
    height: 30px;
    margin: 0;
    flex-shrink: 0;
    border: 2px solid var(--border-gray);
    border-radius: 6px;
    accent-color: var(--primary-accent); 
}

.multiselect-search {
    padding: 18px 25px; 
    margin: 10px 15px 20px 15px;
    border: 1px solid var(--border-gray);
    border-radius: 10px; 
    font-size: 30px; 
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.08);
    /* Make search full width of container */
    width: auto; 
}

/* ------------------------------------- */
/* ðŸ’¥ 10. COMPACT MODE (20% SMALLER & ZERO WASTE) */
/* ------------------------------------- */
@media (max-width: 768px) {
    body {
        font-size: 12px !important; 
        overflow-x: hidden;
    }
    
    * {
        box-sizing: border-box !important;
    }

    .container, .main-content {
        width: 100% !important;
        padding: 5px !important; 
        margin: 0 !important;
    }

    /* --- FIXED MENU TOGGLE: TOP RIGHT FOR MOBILE --- */
    .menu-toggle { 
        top: 10px !important; 
        right: 10px !important; 
        left: auto !important;  
        padding: 10px 15px !important; 
        font-size: 20px !important; 
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
        position: fixed !important; 
        z-index: 1001;
    }

    /* LOGO & TITLES */
    .logo-container { margin-bottom: 15px !important; }
    .logo-container img {
        max-width: 140px !important; 
    }
    h1 { font-size: 18px !important; margin: 5px 0 !important; }
    h2 { font-size: 14px !important; margin: 0 !important; }

    /* INPUTS & BUTTONS - Slim & Sleek */
    select, 
    .materials-input,
    .search-input,
    .status-button,
    .save-button,
    .add-material-button,
    .signature-group .status-button {
        height: 38px !important; 
        padding: 4px 8px !important; 
        font-size: 13px !important; 
        margin-top: 3px !important;
        margin-bottom: 3px !important;
        border-radius: 4px !important;
    }

    /* SEARCH BAR */
    .search-container {
        display: flex;
        flex-direction: row !important;
        gap: 4px;
        margin-bottom: 15px !important;
    }
    .search-input { flex: 3; }
    .search-button { flex: 1; min-height: 38px !important; font-size: 13px !important; }

    /* TICKET HEADERS */
    .page-header {
        font-size: 14px !important;
        padding: 8px 12px !important;
    }
    
    .page-subheader {
        font-size: 12px !important;
        padding: 6px 12px !important;
    }

    /* LABELS & SPANS */
    .page-content label {
        font-size: 11px !important;
        margin-top: 6px !important;
        padding-left: 6px !important;
        border-left: 3px solid var(--color-primary) !important;
    }
    .page-content span, 
    .page-content .ticket-details {
        font-size: 13px !important;
        margin-bottom: 6px !important;
        padding: 8px !important;
    }

    /* THE "FROM-TO" ROW */
    .from-to-container, .dynamic-material-row {
        display: flex !important;
        flex-direction: row !important;
        gap: 4px !important;
    }
    .delete-material-button {
        width: 38px !important;
        height: 38px !important;
        font-size: 14px !important;
    }

    /* --- SQUEEZED TABLE FIX (NO SWIPE) --- */
    .data-table-container {
        margin: 10px 0 !important;
        width: 100% !important;
        overflow-x: hidden !important; /* Kill the swipe */
        border-radius: 8px !important;
        box-shadow: none !important;
        border: 1px solid var(--border-color) !important;
    }

    .data-table {
        min-width: 100% !important; /* Force it to be exactly screen width */
        width: 100% !important;
        table-layout: fixed !important; /* Force columns to share space */
    }

    .data-table th, .data-table td {
        padding: 4px 2px !important; /* Minimal padding to save space */
        font-size: 10px !important; /* Very small text to fit */
        word-wrap: break-word !important; /* Wrap long words */
        overflow-wrap: break-word !important;
        white-space: normal !important; /* Allow text to wrap to next line */
        text-align: center !important;
    }

    /* SIGNATURE & UPLOADS */
    .signature-group { padding: 10px !important; margin-top: 15px !important; }
    .signature-group canvas { height: 150px !important; }
    .upload-form { margin-top: 20px !important; padding-top: 15px !important; }
    .file-group { padding: 10px !important; margin-bottom: 10px !important; }

    .file-group input[type="file"] {
        padding: 8px 0 !important;
        font-size: 13px !important;
    }
    
    /* SIDEBAR */
    .sidebar.open { width: 75% !important; }
    .sidebar-header { font-size: 18px !important; padding: 15px !important; }
    .menu-item a { font-size: 15px !important; padding: 12px 20px !important; }

    /* MULTISELECT MOBILE ADJUSTMENT */
    .multiselect-options {
        z-index: 100;
        max-height: 400px !important;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        background: #ffffff;
        border-radius: 10px;
        padding: 10px !important;
        gap: 8px !important; 
        min-width: 100% !important; 
        width: 100% !important;
    }

    .multiselect-search {
        padding: 10px 12px !important; 
        margin: 5px 10px 10px 10px !important; 
        font-size: 14px !important; 
        border-radius: 6px !important;
        width: calc(100% - 20px) !important;
    }

    .category-title {
        font-weight: 800;
        font-size: 18px !important; 
        border-bottom: 2px solid var(--border-gray) !important; 
        margin-bottom: 8px !important;
        padding-top: 5px !important;
    }

    /* SEARCH BUTTON FIX */
    .search-button {
        white-space: nowrap;
        padding: 0 10px !important;
    }

    .materials-container {
        padding: 12px !important;
        margin-bottom: 20px !important;
    }

    .materials-container h2 {
        font-size: 20px !important;
        margin-bottom: 15px !important;
    }

    /* TABLE ACTIONS */
    .table-actions {
        text-align: center !important;
        margin-bottom: 15px !important;
    }

    .table-actions button {
        width: 100% !important;
        height: 44px !important;
        font-size: 16px !important;
    }
}

/* Nested Items Table Styling */
.inner-table-wrapper {
    background: #ffffff;
    border-radius: 8px;
    padding: 10px;
    border: 1px solid #e0e0e0;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
}

.inner-items-table th {
    text-transform: uppercase;
    font-size: 11px;
    letter-spacing: 0.5px;
    color: #555;
}

.inner-items-table tr:last-child {
    border-bottom: none !important;
}

/* Mobile tweak for the inner table */
@media (max-width: 768px) {
    .inner-items-table {
        font-size: 11px !important;
    }
    .inner-table-wrapper h4 {
        font-size: 14px !important;
    }
}

/* --- MATERIAL REQUEST REDESIGN --- */
.request-form-container {
    max-width: 600px;
    margin: auto;
}

.section-label {
    display: block;
    margin-top: 25px;
    font-weight: 800;
    font-size: 14px;
    color: var(--primary-accent);
    border-left: 4px solid var(--primary-accent);
    padding-left: 10px;
    margin-bottom: 15px;
}

.request-card {
    background: #fdfdfd;
    border: 1px solid #eee;
    border-radius: 12px;
    padding: 12px;
    margin-bottom: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.03);
    transition: all 0.2s ease;
}

.request-card:focus-within {
    border-color: var(--primary-accent);
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.request-card-row {
    display: flex;
    gap: 8px;
    margin-bottom: 8px;
    align-items: center;
}

.remark-input {
    background-color: #f8f9fa !important;
    border: 1px dashed #ccc !important;
    font-size: 12px !important;
    height: 34px !important;
}

.add-item-btn {
    width: 100%;
    padding: 12px;
    background: #6c757d;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 5px;
}

.remove-row-btn {
    background: #ffeded;
    color: #dc3545;
    border: none;
    width: 38px;
    height: 38px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.submit-request-button {
    background: var(--primary-accent);
    color: white;
    width: 100%;
    padding: 15px;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    font-weight: bold;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

/* Mobile Tweaks */
@media (max-width: 768px) {
    .request-card { padding: 10px; }
    .item-select { font-size: 11px !important; }
    .qty-input { width: 60px !important; font-size: 11px !important; }
}

/* --- ADD THIS TO YOUR @media (max-width: 768px) SECTION in CSS.HTML --- */

/* 1. Global Safety - Keep this outside the media query */
.detail-row {
    display: none;
}

@media (max-width: 768px) {
    /* --- YOUR EXISTING CSS (KEEPING EVERYTHING) --- */
    .request-card {
        padding: 8px !important;
        margin-bottom: 10px !important;
        background: #ffffff !important;
        border: 1px solid #ddd !important;
    }

    .request-card-row {
        display: flex !important;
        gap: 5px !important;
        flex-wrap: nowrap !important;
    }

    .item-select {
        flex: 3 !important;
        min-width: 0 !important;
    }

    .quantity-input {
        width: 65px !important;
        flex: none !important;
    }

    .remove-row-btn {
        width: 38px !important;
        flex: none !important;
    }

    .remark-input {
        width: 100% !important;
        margin-top: 8px !important;
        font-size: 12px !important;
        display: block !important;
    }

    .submit-request-button {
        padding: 12px !important;
        font-size: 16px !important;
    }
    
    .section-label {
        font-size: 12px !important;
        margin-top: 15px !important;
    }

    .detail-row td {
        padding: 0 !important; 
    }

    .nested-table {
        width: 100% !important;
        margin: 0 !important;
        border-left: 4px solid var(--color-primary) !important;
        border-collapse: collapse !important;
    }

    .nested-table th {
        background: #f1f1f1 !important;
        font-size: 9px !important;
        padding: 5px 2px !important;
        text-transform: uppercase;
    }

    .nested-table td {
        font-size: 10px !important;
        padding: 8px 4px !important;
        border-bottom: 1px solid #eee !important;
        text-align: left !important;
    }

    /* Animation */
    .detail-row[style*="table-row"] {
        animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    /* --- ADDING NEW MONITORING STYLES BELOW (MOBILE OPTIMIZED) --- */
    
    .refresh-button {
        padding: 8px 15px !important;
        font-size: 14px !important;
        margin-left: 5px !important;
    }

    .status-badge {
        padding: 4px 8px !important;
        border-radius: 12px !important;
        font-size: 8px !important; /* Smaller for mobile tables */
        font-weight: bold !important;
        display: inline-block !important;
        text-align: center !important;
        min-width: 90px !important;
    }

    .status-activated {
        background-color: #d4edda !important;
        color: #155724 !important;
        border: 1px solid #c3e6cb !important;
    }

    .status-for-activation {
        background-color: #fff3cd !important;
        color: #856404 !important;
        border: 1px solid #ffeeba !important;
    }
}

/* Outside media query for desktop defaults */
.status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: bold;
    display: inline-block;
    min-width: 120px;
    text-align: center;
}
.status-activated { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
.status-for-activation { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; }


  </style>
</head>
<body>

  <div id="auth-fallback">
    <img src="https://i.ibb.co/ZqC6Lpf/Galaxy-Fiber-Logo-350x100pixels.png" width="200" alt="Logo">
    <h3>Access Restricted by Google</h3>
    <p>Mobile browsers often block Google Apps Script inside other sites.</p>
    <a href="https://script.google.com/macros/s/AKfycbxN3kgi1RBIqK9xD9kW3pWX8bLXY1Kna4hZeaaqbu_VUjo9wvMPEYAPC3QfULLfapYn/exec" 
       target="_blank" 
       class="login-button">
       OPEN APP IN NEW TAB
    </a>
    <p style="font-size: 12px; color: #666; margin-top: 15px;">After logging in, you can return here and refresh.</p>
  </div>

  <iframe 
    id="appIframe"
    src="https://script.google.com/macros/s/AKfycbxN3kgi1RBIqK9xD9kW3pWX8bLXY1Kna4hZeaaqbu_VUjo9wvMPEYAPC3QfULLfapYn/exec"
    allow="geolocation"
    allowfullscreen="true">
  </iframe>

  <script>
    // 1. Fullscreen Logic
    window.onload = function() {
      const iframe = document.getElementById('appIframe');
      
      // Attempt fullscreen (Note: Mobile browsers often require a click first)
      iframe.requestFullscreen().catch((err) => {
        console.log("Auto-fullscreen blocked. This is normal for mobile security.");
      });

      // 2. 403 Error Detection
      // If we don't receive a message from the app, or after 6 seconds, 
      // we show the manual login button for users who are blocked.
      setTimeout(function() {
        // We check if the iframe is actually displaying content
        // If it's blocked by a 403, we can't read its content, but we can guess it failed
        try {
          const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
          if (!iframeDoc || iframeDoc.body.innerHTML.length === 0) {
            showFallback();
          }
        } catch (e) {
          // If we hit a CORS error here, it means the iframe loaded something 
          // from Google, which is actually a GOOD sign. 
          console.log("App loaded or blocked by Google Auth Policy.");
        }
      }, 6000);
    };

    function showFallback() {
      document.getElementById('auth-fallback').style.display = 'flex';
      document.getElementById('appIframe').style.display = 'none';
    }
  </script>
</body>
</html>
